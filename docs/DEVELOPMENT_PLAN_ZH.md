# rarch (归藏) 开发计划书

本文档概述了 **rarch** 开发的战略路线图。每个阶段都是从一个稳健的工具向全面的数据管理生态系统转变的重要里程碑。

## 阶段 1：基础建设与可靠性
*目标：技术成熟度与核心稳定性。*

- **增强型日志系统**：实现冗余日志备份，确保即使在操作过程中发生硬件故障，也能 100% 恢复数据。
- **扩展内容检测**：扩大 `infer` 引擎的识别范围，支持专业的科学、工程及稀有媒体格式。
- **TUI 界面精修**：引入可配置的仪表盘，包含实时性能指标和交互式规则审计功能。
- **全面测试套件**：引入针对硬链接去重等高风险操作的属性分配测试。

## 阶段 2：性能极致优化
*目标：触及现代存储硬件的性能极限。*

- **零拷贝 I/O**：利用 `sendfile` 和 `splice` (Linux) 技术，在同一文件系统内移动文件时将 CPU 开销降至最低。
- **异步引擎**：将扫描和处理流水线迁移至完全异步模型，以最大化 NVMe 存储的 IOPS 利用率。
- **确定性去重**：利用 SIMD 指令优化 SHA-256 流水线，实现更快捷的大规模文件哈希计算。
- **内存分析优化**：大幅降低“守望模式 (Watch Mode)”在低功耗设备上后台运行时的内存占用。

## 阶段 3：自动化与高度集成
*Target: 从工具向服务的演进。*

- **脚本引擎**：集成轻量级脚本语言（如 Rhai），允许用户定义复杂的、有状态的整理逻辑。
- **云端网关**：实验性支持通过 Rclone 或原生的 S3/WebDAV 集成整理远程存储中的文件。
- **通知系统**：支持 Webhook 和桌面通知，用于汇报批量操作摘要和安全警报。
- **高级触发器**：基于条件的执行（例如：“仅当磁盘占用超过 80% 时运行清理”）。

## Phase 4: 生态扩张与全球化
*Target: 广泛的易用性与社区成长。*

- **rarch 注册表**：建立中心化平台，供社区分享和发现针对不同工作流（如摄影、开发、归档）的规则模板。
- **桌面图形界面**：开发基于 Tauri 的跨平台 GUI，为偏好图形化而非终端环境的用户提供服务。
- **移动端助手**：开发移动端简化版 rarch，协助整理手机本地媒体资产。
- **开发者库 (API)**：将核心引擎正式封装为库 (`librarch`)，赋能其他开发者构建内容感知类工具。
